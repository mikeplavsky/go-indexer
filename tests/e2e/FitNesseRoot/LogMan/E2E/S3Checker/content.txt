!define CUSTOMER !-Customer-!

|import|
|s3    |

|subset query:S3 Buckets|
|Name                   |
|dmp-log-analysis       |
|logmanagement          |

|script|logs      |${CUSTOMER}|
|clean s3 up                  |
|check |logs on s3|0          |

|query:S3 Logs|dmp-log-analysis|${CUSTOMER}|
|Path                                      |

|script|ssh                                        |
|check |remove|go-sync              |container|true|
|check |delete|localhost:8080/s3data|true          |
|check |get   |localhost:8080/s3data|=~/IndexMissingException/|

|script|logs      |${CUSTOMER}|
|upload|10        |logs to s3 |
|check |logs on s3|10         |

|subset query:S3 Logs   |dmp-log-analysis  |${CUSTOMER}  |
|Path                                                    |
|${CUSTOMER}!-/MachineB/Agent0/MAgE_20150331_023936.zip-!|
|${CUSTOMER}!-/MachineB/Agent1/MAgE_20150331_023936.zip-!|
|${CUSTOMER}!-/MachineB/Agent2/MAgE_20150331_023936.zip-!|

|script|ssh                          |
|check |run|./run_s3.sh  |script|true|

!include S3Data

|script|ssh                          |
|check |run|./run_sync.sh|script|true|




